Create exactly 5 fill-in-the-blank questions for "{{main_word}}" ({{main_word_translations}}), translating from "{{fromLang}}" to "{{toLang}}". If you cannot generate 5 high-quality questions, generate as many as you can (minimum 3).

CRITICAL: Use Chain-of-Thought process:

STEP 1: CONTEXTUAL ANALYSIS & SYNTAX PLANNING
- Analyze word/idiom/syntax meaning and identify its complete structure
- Preserve {{main_word}} and {{main_word_translations}} exactly as provided (only minor corrections allowed)
- Plan natural sentence structures where the target concept serves as the grammatical backbone
- Design scenarios where the target concept naturally anchors the sentence structure

STEP 2: CREATE SYNTAX-ANCHORED SENTENCES
- Build sentences where the target concept is the structural core
- Ensure the concept naturally connects multiple sentence elements
- Create sentences where removing the target concept would break the grammatical flow
- Focus on sentences where the concept serves as a bridge, connector, or structural pivot

STEP 3: STRATEGIC CORE MASKING
- Identify the 1-3 word core that maintains syntactic integrity
- Mask only the essential grammatical core, not peripheral elements
- Ensure the blank represents the structural heart of the sentence
- Create blanks that test understanding of the target concept's grammatical role

STEP 4: SYNTAX VALIDATION
- Verify the sentence remains grammatically coherent without the masked core
- Ensure the blank position tests the target concept's syntactic function
- Validate that the answer requires understanding of grammatical structure
- Confirm the sentence flows naturally when the core is filled in

STEP 5: RECURSIVE SELF-REVIEW (2-3 iterations)
- Review each question from a learner's perspective
- Identify unnatural phrasing, awkward constructions, or unclear contexts
- Refine sentences to sound more natural and native-like
- Ensure the masked core is the most logical and pedagogically effective choice
- Repeat review process until questions meet native-speaker quality standards

ADVANCED GUIDELINES:

**SYNTACTIC ANCHORING:**
- Target concept must serve as the grammatical backbone of the sentence
- Create sentences where the concept connects or bridges multiple elements
- Focus on structural relationships rather than simple vocabulary replacement
- Ensure the concept is the syntactic pivot that holds the sentence together

**CONTEXTUAL DIVERSITY:**
1. Daily Life: Routine activities, personal habits
2. Social Interaction: Conversations with friends, family, colleagues
3. Professional/Academic: Work meetings, academic discussions
4. Cultural/Social: Traditions, customs, social events
5. Media/Entertainment: Movies, books, news, social media

**DIFFICULTY PROGRESSION:**
- Q1: Basic syntactic connection in simple context
- Q2: Moderate syntactic complexity with multiple elements
- Q3: Intermediate complexity with cultural elements
- Q4: Advanced syntactic structure in professional setting
- Q5: Complex syntactic relationships with nuanced meaning

**CORE MASKING STRATEGY:**
- Mask only the 1-3 word grammatical core of the target concept
- Ensure the blank represents the structural heart, not peripheral elements
- Create blanks that test syntactic understanding, not just vocabulary
- Focus on grammatical relationships and structural connections
- For verb patterns, mask the specific conjugation that fits the context
- Distinguish between wildcard elements (can be any appropriate form) and fixed elements (must be specific)

**CULTURAL SENSITIVITY:**
- Incorporate cultural context specific to target language
- Consider social hierarchies, politeness levels, cultural norms
- Use appropriate formality levels
- Avoid cultural stereotypes

**GRAMMATICAL FLEXIBILITY:**
- Adapt target concept to serve as syntactic anchor within each sentence
- Use appropriate verb forms, tenses, grammatical structures
- Consider regional variations if applicable
- Ensure native-like flow with structural integrity

**VERB CONJUGATION & WILDCARD RULES:**
- Distinguish between verb forms: present (do), past (did), past participle (done)
- Identify wildcard vs fixed usage patterns:
  * Wildcard: "have done" where "done" represents any past participle
  * Fixed: "do me a favor" where "do" is specific and cannot be replaced
- When main_word contains verb patterns, select appropriate conjugation based on context
- For syntax patterns, choose the most natural verb form for the sentence structure
- Ensure verb agreement with subject, tense, and grammatical context

**FIELD-SPECIFIC RULES:**

**main_word and main_word_translations fields:**
- MUST preserve user input exactly as provided (only minor corrections allowed)
- May contain grammatical symbols, patterns, or {{fromLang}} explanations
- These are for human understanding and reference

**quiz questions (question, answer, example_sentences, etc.):**
- Must use natural, complete sentences without grammatical symbols
- Must be proper {{fromLang}} and {{toLang}} content
- Must sound natural to native speakers

**ERROR PREVENTION:**
- Never use grammatical symbols or placeholder text in quiz questions
- Avoid grammar exercise-like sentences in quiz questions
- Ensure complete, usable answers that maintain syntactic structure
- Prevent ambiguity in blank placement

**QUALITY ASSURANCE:**
For each question verify: Natural syntactic structure, cultural context, clear grammatical core, pedagogical effectiveness, appropriate difficulty, varied complexity, realistic scenario.

**CONTENT PRESERVATION:**
- {{main_word}} and {{main_word_translations}} must be preserved exactly as provided (only minor corrections allowed)
- These fields are for human understanding and may contain {{fromLang}} explanations, grammatical symbols, or patterns
- The actual quiz questions should use proper {{fromLang}} and {{toLang}} content
- Grammatical symbols and patterns in main_word/main_word_translations are intentional and should NOT be converted to actual words

**RECURSIVE REVIEW PROCESS:**
After initial generation, review each question 2-3 times from a learner's perspective. Ask yourself:

**For main_word and main_word_translations:**
- Is the main_word field preserving the exact original {{main_word}} content?
- Is the main_word_translations field preserving the exact original {{main_word_translations}} if provided?

**For quiz questions:**
- Does this sound natural to a native speaker?
- Is the masked core the most logical choice?
- Would a learner find this context clear and helpful?
- Can this be improved for better pedagogical value?
- Are the quiz questions using proper {{fromLang}} and {{toLang}} content?
- Is the verb conjugation appropriate for the context and tense?
- Are wildcard vs fixed elements correctly identified and used?

Refine questions iteratively until they meet native-speaker quality standards.

If you cannot generate exactly 5 high-quality questions meeting ALL criteria, return as many valid questions as you can (minimum 3), but do NOT include substandard questions. Always try to generate 5 questions first.

For main_word_translations: If user provides {{main_word_translations}}, use them exactly as provided. If user doesn't provide, research and generate suitable translation in {{fromLang}}. Never leave empty.

Each question must include:
- Natural sentence in {{toLang}} with one blank ("____") masking the syntactic core
- Correct answer (1-3 word grammatical core that maintains sentence structure)
- Main word being tested (main_word) - MUST contain the exact original {{main_word}} content
- 1-3 translations in {{fromLang}} (main_word_translations: array) - MUST contain the exact original {{main_word_translations}} if provided
- 2-3 example sentences using main_word naturally with translations (example_sentences: array of objects with 'sentence' and 'translation')
- Explanation in {{fromLang}} about main word (explanation) - ONLY {{fromLang}}, max 3 lines
- Sentence translation into {{fromLang}}
- Dictionary object with max 2 words per sentence, 2-6 meanings each in {{fromLang}}, advanced vocabulary only
- 4 progressive hints in {{fromLang}} (hint_levels):
  1. Sentence meaning in {{fromLang}}
  2. Grammatical clue in {{fromLang}}
  3. Answer word explanation in {{fromLang}}
  4. Partial word clue in {{fromLang}}

**DICTIONARY REQUIREMENTS:**
- Advanced vocabulary only (upper-intermediate to advanced)
- Exclude intermediate-level words
- Focus on sophisticated, academic, specialized terms
- Max 2 entries per sentence for focused learning

**EXAMPLE SENTENCES:**
- Real-world usage scenarios
- Practical vocabulary from daily life
- Cultural context and situational appropriateness
- Authentic materials vocabulary

**LANGUAGE REQUIREMENTS:**
- ALL explanations, hints, translations MUST be in {{fromLang}} only
- If cannot write in {{fromLang}}, return error

Return ONLY JSON object with "questions" array of exactly 5 question objects. No markdown or code blocks. If cannot generate 5, return as many as you can (minimum 3). If cannot generate at least 3, return {"error": "Could not generate sufficient questions"}.

Example format:
{
  "questions": [
    {
      "question": "Él ____ todos los días.",
      "answer": "habla",
      "main_word": "hablar",
      "main_word_translations": ["話す", "しゃべる"],
      "explanation": "『hablar』はスペイン語で『話す』という意味で、日常会話や授業など様々な場面で使われます。",
      "sentence_translation": "彼は毎日話します。",
      "fromLang": "ja",
      "toLang": "es",
      "dictionary": {
        "él": ["彼"],
        "todos los días": ["毎日"],
        "habla": ["話す", "しゃべる"]
      },
      "hint_levels": [
        "彼は毎日〇〇します。",
        "現在形、三人称単数の動詞が入ります。",
        ""話す" の意味で、動詞 "hablar" の活用形です。",
        "ha____"
      ]
    }
  ]
}